<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoanPro - Loan Management System</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üí∞</text></svg>">
</head>
<body>
    <header class="header">
        <div class="container header-content">
            <div class="logo">
                <i class="fas fa-hand-holding-usd"></i>
                <span>LoanPro</span>
            </div>
            <img src="images-removebg-preview.png" alt="LoanPro Logo">
            <nav class="nav-links">
                <a href="#" class="nav-link" id="homeLink">
                    <i class="fas fa-home"></i> Home
                </a>
                <a href="#" class="nav-link" id="customerLoginLink">
                    <i class="fas fa-user"></i> Customer Login
                </a>
                <a href="#" class="nav-link" id="ownerLoginLink">
                    <i class="fas fa-user-shield"></i> Owner Login
                </a>
            </nav>
        </div>
    </header>

    <div id="homePage" class="page container">
        <div class="card">
            <h1>Welcome to LoanPro</h1>
            <p>Your trusted partner for managing loans efficiently and transparently.</p>
            
            
            <h2>How It Works</h2>
            <div class="stats-container">
                <div class="stat-card">
                    <h3><i class="fas fa-user-check"></i> For Customers</h3>
                    <p>Login with your phone number to view your loan details, payment history, and remaining balance.</p>
                    <ul style="text-align: left; margin-top: 15px;">
                        <li>View your loan status</li>
                        <li>Track payment history</li>
                        <li>Check remaining balance</li>
                        <li>Monitor payment deadlines</li>
                    </ul>
                </div>
                <div class="stat-card">
                    <h3><i class="fas fa-user-shield"></i> For Owners</h3>
                    <p>Access the owner dashboard to manage all customer accounts and track loan performance.</p>
                    <ul style="text-align: left; margin-top: 15px;">
                        <li>Manage customer accounts</li>
                        <li>Track loan performance</li>
                        <li>Update payment records</li>
                        <li>Generate financial reports</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div id="customerLoginPage" class="page container hidden">
        <div class="card login-form">
            <h2><i class="fas fa-user"></i> Customer Login</h2>
            <p>Enter your phone number to access your account</p>
            
            <div class="form-group">
                <label class="form-label" for="customerPhone">
                    <i class="fas fa-mobile-alt"></i> Phone Number
                </label>
                <input type="text" id="customerPhone" placeholder="Enter your phone number">
            </div>
            
            <button class="btn btn-primary" id="customerLoginBtn">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
            <button class="btn" id="backFromCustomerLogin">
                <i class="fas fa-arrow-left"></i> Back to Home
            </button>
        </div>
    </div>

    <div id="ownerLoginPage" class="page container hidden">
        <div class="card login-form">
            <div class="login-header" style="text-align: center; margin-bottom: 30px;">
                <i class="fas fa-hand-holding-usd" style="font-size: 3rem; color: var(--primary); margin-bottom: 15px;"></i>
                <h2>LoanPro Owner Portal</h2>
                <p style="color: var(--gray-medium); margin-top: 10px;">Secure access to your dashboard</p>
            </div>
            
            <form id="ownerLoginForm">
                <div class="form-group">
                    <label class="form-label" for="ownerEmail">
                        <i class="fas fa-envelope"></i> Email
                    </label>
                    <input type="email" id="ownerEmail" value="owner@loanpro.com" readonly 
                           style="background-color: #f8f9fa; cursor: not-allowed;">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="ownerPassword">
                        <i class="fas fa-lock"></i> Password
                    </label>
                    <input type="password" id="ownerPassword" placeholder="Enter your password" required 
                           autofocus>
                </div>
                
                <button type="submit" class="btn btn-primary btn-login" style="width: 100%; padding: 15px; font-size: 16px;">
                    <i class="fas fa-sign-in-alt"></i> Login to Dashboard
                </button>
            </form>
            
            <div style="text-align: center; margin-top: 20px; padding: 15px; background: var(--light); border-radius: var(--border-radius);">
                <p style="margin: 0; color: var(--gray-medium); font-size: 14px;">
                    Default password: <strong>admin123</strong>
                </p>
            </div>
            
            <button class="btn" id="backFromOwnerLogin" style="width: 100%; margin-top: 15px;">
                <i class="fas fa-arrow-left"></i> Back to Home
            </button>
        </div>
    </div>

    <!-- Debug Console (remove in production) -->
    <div style="position: fixed; bottom: 10px; right: 10px; background: #333; color: white; padding: 10px; border-radius: 5px; font-size: 12px; z-index: 1000;">
        <div>Console: <span id="debugStatus">Ready</span></div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2023 LoanPro - Loan Management System. All rights reserved.</p>
            <p>Secure. Reliable. Transparent.</p>
        </div>
    </footer>

    <script src="config.js"></script>
    <script>
        // ‚úÖ Enhanced Owner Login Functionality
        document.addEventListener('DOMContentLoaded', function() {
            console.log("üöÄ LoanPro Frontend Initialized");
            
            // Set API Base URL
            window.API_BASE = window.API_BASE || "https://loanpro-backend-t41k.onrender.com";
            console.log("üåê API Base URL:", window.API_BASE);

            // Owner Login Form Handler
            const ownerLoginForm = document.getElementById('ownerLoginForm');
            if (ownerLoginForm) {
                ownerLoginForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const email = document.getElementById('ownerEmail').value;
                    const password = document.getElementById('ownerPassword').value;
                    const button = document.querySelector('.btn-login');
                    
                    if (!password) {
                        alert('Please enter your password');
                        return;
                    }

                    // Show loading state
                    const originalText = button.innerHTML;
                    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Logging in...';
                    button.disabled = true;

                    try {
                        console.log("üîê Attempting owner login...");
                        
                        const response = await fetch(`${window.API_BASE}/api/owner/login`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ email, password })
                        });
                        
                        const data = await response.json();
                        console.log("üì° Login response:", data);

                        if (response.ok && data.success) {
                            // Store login state
                            localStorage.setItem('ownerLoggedIn', 'true');
                            localStorage.setItem('ownerEmail', email);
                            
                            // Show success message
                            alert('‚úÖ Login successful! Redirecting to dashboard...');
                            
                            // Redirect to dashboard
                            setTimeout(() => {
                                window.location.href = 'owner.html';
                            }, 1000);
                            
                        } else {
                            alert(data.message || 'Login failed. Please check your credentials.');
                        }
                        
                    } catch (error) {
                        console.error('‚ùå Login error:', error);
                        alert('Connection error. Please check if server is running.');
                    } finally {
                        // Reset button
                        button.innerHTML = originalText;
                        button.disabled = false;
                    }
                });

                // Auto-focus password field when owner login page is shown
                const ownerLoginLink = document.getElementById('ownerLoginLink');
                if (ownerLoginLink) {
                    ownerLoginLink.addEventListener('click', function() {
                        setTimeout(() => {
                            const passwordField = document.getElementById('ownerPassword');
                            if (passwordField) {
                                passwordField.focus();
                            }
                        }, 100);
                    });
                }
            }

            // Page navigation functions (from script.js)
            function hideAllPages() {
                const pages = document.querySelectorAll('.page');
                pages.forEach(page => page.classList.add('hidden'));
            }

            function showHomePage() {
                hideAllPages();
                document.getElementById('homePage').classList.remove('hidden');
            }

            function showCustomerLogin() {
                hideAllPages();
                document.getElementById('customerLoginPage').classList.remove('hidden');
            }

            function showOwnerLogin() {
                hideAllPages();
                document.getElementById('ownerLoginPage').classList.remove('hidden');
            }

            // Event listeners for navigation
            document.getElementById('homeLink')?.addEventListener('click', showHomePage);
            document.getElementById('customerLoginLink')?.addEventListener('click', showCustomerLogin);
            document.getElementById('ownerLoginLink')?.addEventListener('click', showOwnerLogin);
            document.getElementById('backFromCustomerLogin')?.addEventListener('click', showHomePage);
            document.getElementById('backFromOwnerLogin')?.addEventListener('click', showHomePage);

            // Show home page by default
            showHomePage();
        });
    </script>
    <script src="script.js"></script>
</body>
</html>
